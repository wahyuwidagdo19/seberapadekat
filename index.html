<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Seberapa Dekat Kamu dengan Wahyu</title>
<style>
body{
  margin:0;height:100vh;
  background: linear-gradient(135deg,#0b0b0b,#1e1e1e);
  background-size:400% 400%;
  animation:bgAnim 15s ease infinite;
  color:white;font-family:Arial;
  display:flex;justify-content:center;align-items:flex-start;
  overflow:hidden;padding-top:20px;
}
@keyframes bgAnim{
  0%{background-position:0 0;}
  50%{background-position:100% 100%;}
  100%{background-position:0 0;}
}
.card{
  background:rgba(0,255,204,0.06);
  padding:30px;border-radius:18px;
  width:360px;text-align:center;
  box-shadow:0 0 40px rgba(0,255,204,0.3);
  transition: transform .2s, box-shadow .2s;
  margin-bottom:20px;
}
.card:hover{
  transform:scale(1.03);
  box-shadow:0 0 60px rgba(0,255,204,0.6);
}
h1{color:#00ffcc;text-shadow:0 0 12px #00ffcc;}
button,input{
  width:100%;padding:12px;border-radius:25px;
  border:none;margin:8px 0;font-weight:bold;
  transition: all .2s;
}
button:hover{
  opacity:.85;transform:scale(1.05);
  box-shadow:0 0 10px #00ffcc,0 0 20px #00ffcc;
}
button{background:#00ffcc;cursor:pointer;color:black;font-weight:bold;}
button:disabled{opacity:.6;cursor:not-allowed;}
.correct{background:#2ecc71!important;color:black;box-shadow:0 0 20px #2ecc71;animation:correctFlash .4s;}
.wrong{background:#ff4d4d!important;color:white;box-shadow:0 0 20px #ff4d4d;animation:wrongFlash .4s;}
@keyframes correctFlash{0%,100%{transform:scale(1);}50%{transform:scale(1.1);}}
@keyframes wrongFlash{0%,100%{transform:scale(1);}50%{transform:scale(0.9) rotate(-5deg);}}
.topbar{display:flex;justify-content:space-between;font-size:14px;margin-bottom:8px}
.progress{color:#00ffcc;flex:1;position:relative;}
.progress-bar{
  position:absolute;left:0;top:50%;transform:translateY(-50%);
  height:6px;background:#00ffcc;border-radius:3px;
  transition: width .5s, background .5s;
}
.timer{color:#ffcc00}
.leaderboard{
  text-align:left;margin-top:15px;background:rgba(0,0,0,0.2);padding:10px;border-radius:12px;width:360px;
}
.leaderboard li{margin:6px 0;transition:all .4s;}
.leaderboard li.top1{color:#ffd700;font-weight:bold;text-shadow:0 0 8px #ffd700;transform:scale(1.05);}
.badge{
  background:#222;padding:6px 10px;border-radius:15px;margin:4px;display:inline-block;
  box-shadow:0 0 12px #00ffcc;
  animation:badgeGlow 1s infinite alternate;
}
@keyframes badgeGlow{0%{box-shadow:0 0 8px #00ffcc;}100%{box-shadow:0 0 20px #00ffcc;}}
</style>
</head>
<body>
<div class="card" id="app">
  <h1>Seberapa Dekat<br>dengan Wahyu?</h1>
  <input id="nameInput" placeholder="Nama lu...">
  <button onclick="start()">START</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyBFhb3EVXEsWaqi83nBmSgl8bbQ5bRgLUg",
  authDomain: "leader-112c2.firebaseapp.com",
  databaseURL: "https://leader-112c2-default-rtdb.firebaseio.com",
  projectId: "leader-112c2",
  storageBucket: "leader-112c2.firebasestorage.app",
  messagingSenderId: "1022417648834",
  appId: "1:1022417648834:web:b648164104585fe314f5b"
});
const db = firebase.database();

let deviceId = localStorage.getItem("deviceId");
if(!deviceId){
  deviceId = "dev-" + Math.random().toString(36).slice(2,10);
  localStorage.setItem("deviceId", deviceId);
}

const RESET_CODE = "192011";
let score=0,index=0,player="",timeLeft=5,timer,locked=false;

const questions=[
 {q:"Buah favorit Wahyu?",o:["üçé Apel","üçä Jeruk","üçå Pisang"],c:"üçä Jeruk"},
 {q:"Lagu favorit Wahyu?",o:["üé∏ Don't Look Back in Anger","üéß Yellow","üé∂ Fix You"],c:"üé∏ Don't Look Back in Anger"},
 {q:"Hobi utama Wahyu?",o:["üìñ Membaca","üéÆ Bermain Game","üò¥ Tidur"],c:"üéÆ Bermain Game"},
 {q:"Game favorit Wahyu?",o:["‚öΩ FIFA","üî• Mobile Legends","üß± Minecraft"],c:"üî• Mobile Legends"},
 {q:"Rank tertinggi Wahyu?",o:["Mythic","üëë Immortal","Legend"],c:"üëë Immortal"}
];

const AudioCtx = new (window.AudioContext || window.webkitAudioContext)();
function beep(f,d=0.15){const o=AudioCtx.createOscillator(),g=AudioCtx.createGain();o.frequency.value=f;o.connect(g);g.connect(AudioCtx.destination);o.start();g.gain.exponentialRampToValueAtTime(.0001,AudioCtx.currentTime+d);o.stop(AudioCtx.currentTime+d);}
function confetti(){for(let i=0;i<160;i++){const c=document.createElement("div");c.style=`position:fixed;left:${Math.random()*100}%;top:-10px;width:10px;height:10px;background:hsl(${Math.random()*360},100%,70%);border-radius:50%;transform:rotate(${Math.random()*360}deg);animation:fall 2.5s linear`;document.body.appendChild(c);setTimeout(()=>c.remove(),2500);}}

function start(){
  player=nameInput.value.trim();
  if(!player)return alert("Nama dulu üòÖ");
  score=0;index=0;showQ();
}

function showQ(){
  locked=false;clearInterval(timer);timeLeft=5;
  const q=questions[index];
  const progressPercent=Math.round((index/questions.length)*100);
  const colorHue = progressPercent*1.2;
  app.innerHTML=`
    <div class="topbar">
      <div class="progress">Progress: ${progressPercent}%
        <div class="progress-bar" style="width:${progressPercent}%;background:hsl(${colorHue},100%,50%)"></div>
      </div>
      <div class="timer">‚è± ${timeLeft}</div>
    </div>
    <h1>${q.q}</h1>
  `;
  shuffle([...q.o]).forEach(ans=>{
    const b=document.createElement("button");
    b.textContent=ans;
    b.onclick=()=>answer(b,ans);
    app.appendChild(b);
  });
  timer=setInterval(()=>{
    timeLeft--;
    document.querySelector(".timer").textContent="‚è± "+timeLeft;
    if(timeLeft<=0){clearInterval(timer);beep(200);next();}
  },1000);
}

function answer(btn,ans){
  if(locked) return;
  locked=true;clearInterval(timer);
  document.querySelectorAll("button").forEach(b=>b.disabled=true);
  if(ans===questions[index].c){score++;btn.classList.add("correct");beep(800);}
  else{btn.classList.add("wrong");beep(200);}
  setTimeout(next,500);
}

function next(){index<questions.length-1?(index++,showQ()):result();}

function result(){
  const percent=Math.round(score/questions.length*100);
  if(percent===100) confetti();

  const ref=db.ref("leaderboard/"+deviceId);
  ref.update({name:player,percent,time:Date.now()},()=>showResultBox(percent));
}

function showResultBox(percent){
  // Kata-kata motivasi / nyolot
  let msg='', displayPercent=percent+'%';
  if(percent===100) msg='TRUE BROTHER';
  else if(percent>=80) msg='TOP PLAYER';
  else if(percent>=60) msg='KEEP TRYING';
  else if(percent>=40) msg='NOT BAD';
  else msg='Lu siape? Emang kita kenal?';

  app.innerHTML=`<h1>${msg}</h1><p style="margin-top:10px;font-size:18px">${displayPercent}</p>`;
  showLeaderboard();
}

function showLeaderboard(){
  const lbCard = document.createElement('div');
  lbCard.className='leaderboard card';
  lbCard.innerHTML=`<h3>üèÜ Leaderboard</h3><ol id="lbList"></ol><button onclick="location.reload()">Main Lagi</button><button onclick="resetLB()">Reset Leaderboard</button>`;
  document.body.appendChild(lbCard);

  const lbList = lbCard.querySelector('#lbList');
  db.ref("leaderboard").once("value",snap=>{
    const data=[];
    snap.forEach(c=>data.push(c.val()));
    data.sort((a,b)=>b.percent!==a.percent?b.percent-a.percent:a.time-b.time);
    const top5=data.slice(0,5);
    lbList.innerHTML=top5.map((x,i)=>`<li class="${i===0?'top1':''}">${i===0?'üëë ':'#'+(i+1)+' '}${x.name} ‚Äî ${x.percent}%</li>`).join("");

    // badge TRUE BROTHER
    document.querySelectorAll('.badge').forEach(b=>b.remove());
    const playerData = top5.find(x=>x.name===player && x.percent===100);
    if(playerData){
      const badge = document.createElement('div');
      badge.className='badge';
      badge.textContent='üëë TRUE BROTHER';
      document.body.appendChild(badge);
    }
  });
}

function resetLB(){
  if(prompt("Kode reset:")==RESET_CODE){
    db.ref("leaderboard").remove();
    localStorage.removeItem("deviceId");
    alert("Leaderboard berhasil di-reset");
    location.reload();
  }
}

function shuffle(a){return a.sort(()=>Math.random()-.5);}
</script>
</body>
</html>